import{_ as ue,u as ce,l as me,m as G,k as de,r as N,a as Q,p as A,L as fe,e as x,f as V,s as t,t as ve,v as ge,q as c,x as b,y as R,z as T,A as pe,B as z,D as ye,E as he,F as ke,G as D,ai as K,a3 as W,H as E,I as $,h as l,M as Ne,aj as Se,S as qe,T as be}from"./D87QO4dW.js";import{u as _e}from"./BWVOSsg_.js";import{_ as v}from"./I9wROFQL.js";import"./CD_oK3U4.js";import{d as Fe}from"./BIzRNX9S.js";import{f as X}from"./DJY1H8k3.js";import{g as we}from"./BIGQZk-7.js";import{c as S}from"./DSQ4ZnfI.js";import{r as Le}from"./Dim8bG2a.js";import{q as Ae}from"./BOdCFMn0.js";var _={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"StaffList"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entry"},arguments:[{kind:"Argument",name:{kind:"Name",value:"section"},value:{kind:"StringValue",value:"listingStaffDirectory",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"text"},name:{kind:"Name",value:"summary"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"entries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"section"},value:{kind:"StringValue",value:"staffMember",block:!1}},{kind:"Argument",name:{kind:"Name",value:"orderBy"},value:{kind:"StringValue",value:"nameLast",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"staffMember_staffMember_Entry"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"jobTitle"},name:{kind:"Name",value:"staffMemberJobTitle"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nameFirst"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nameLast"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"to"},name:{kind:"Name",value:"slug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"alternativeName"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"alternativeName_alternativeName_BlockType"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"languageAltName"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"phone"},name:{kind:"Name",value:"phoneNumber"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"consultation"},name:{kind:"Name",value:"bookAConsultation"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"departments"},name:{kind:"Name",value:"staffDepartment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"orderBy"},value:{kind:"StringValue",value:"level",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"locations"},name:{kind:"Name",value:"staffAssociatedLocations"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"uri"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"image"},name:{kind:"Name",value:"staffPortrait"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"Image"},directives:[]}]}}]}}]}}]}}],loc:{start:0,end:975}};_.loc.source={body:`#import "../gql/fragments/Image.gql"
query StaffList {
    entry(section: "listingStaffDirectory") {
        title
        text: summary
    }
    entries(section: "staffMember", orderBy: "nameLast") {
        ... on staffMember_staffMember_Entry {
            jobTitle: staffMemberJobTitle
            nameFirst
            nameLast
            to: slug
            alternativeName {
                ... on alternativeName_alternativeName_BlockType {
                    fullName
                    languageAltName
                }
            }
            email
            phone: phoneNumber
            consultation: bookAConsultation
            departments: staffDepartment(orderBy: "level") {
                id
                title
            }
            locations: staffAssociatedLocations {
                id
                title
                uri
            }
            image: staffPortrait {
                ...Image
            }
        }
    }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};var Y={};function De(n){return n.filter(function(s){if(s.kind!=="FragmentDefinition")return!0;var r=s.name.value;return Y[r]?!1:(Y[r]=!0,!0)})}_.definitions=_.definitions.concat(De(Fe.definitions));function B(n,s){if(n.kind==="FragmentSpread")s.add(n.name.value);else if(n.kind==="VariableDefinition"){var r=n.type;r.kind==="NamedType"&&s.add(r.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(u){B(u,s)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(u){B(u,s)}),n.definitions&&n.definitions.forEach(function(u){B(u,s)})}var H={};(function(){_.definitions.forEach(function(s){if(s.name){var r=new Set;B(s,r),H[s.name.value]=r}})})();function Z(n,s){for(var r=0;r<n.definitions.length;r++){var u=n.definitions[r];if(u.name&&u.name.value==s)return u}}function xe(n,s){var r={kind:n.kind,definitions:[Z(n,s)]};n.hasOwnProperty("loc")&&(r.loc=n.loc);var u=H[s]||new Set,q=new Set,f=new Set;for(u.forEach(function(a){f.add(a)});f.size>0;){var F=f;f=new Set,F.forEach(function(a){if(!q.has(a)){q.add(a);var g=H[a]||new Set;g.forEach(function(p){f.add(p)})}})}return q.forEach(function(a){var g=Z(n,a);g&&r.definitions.push(g)}),r}xe(_,"StaffList");const O=n=>(qe("data-v-4e7b9f53"),n=n(),be(),n),Re={id:"main",class:"page page-staff"},Te={key:0,class:"about-results"},$e={key:1,class:"about-results"},Ee={class:"error-text"},Be=O(()=>l("p",null,[E(" We can’t find the term you are looking for on this page, but we're here to help. "),l("br"),E(" Try searching the whole site from "),l("a",{href:"https://library.ucla.edu"},"UCLA Library Home"),E(", or try one of the these regularly visited links: ")],-1)),Me=O(()=>l("ul",null,[l("li",null,[l("a",{href:"https://www.library.ucla.edu/research-teaching-support/research-help"},"Research Help")]),l("li",null,[l("a",{href:"/help/services-resources/ask-us"},"Ask Us")]),l("li",null,[l("a",{href:"https://www.library.ucla.edu/use/access-privileges/disability-resources"},"Accessibility Resources")])],-1)),Ie=O(()=>l("h3",{class:"section-title subject-librarian"}," Contact a Subject Librarian ",-1)),Ce={__name:"index",async setup(n){var U;let s,r;const{$graphql:u,$dataApi:q}=ce(),{data:f,error:F}=([s,r]=me(async()=>pe("staff-list",async()=>await u.default.request(_))),s=await s,r(),s);if(F.value)throw G({...F.value,statusMessage:"Page not found."+F.value,fatal:!0});if(!f.value.entry&&!f.value.entries)throw G({statusCode:404,message:"Page not found",fatal:!0});const a=de(),g=N(f.value),p=N(v(f.value,"entry",{}));Q(f,(e,i)=>{console.log("In watch preview enabled, newVal, oldVal",e,i),g.value=v(e),p.value=v(e,"entry",{})}),_e({title:g.value?p.value.title:"... loading",meta:[{hid:"description",name:"description",content:Le((U=p.value)==null?void 0:U.text)}]});const ee=A(()=>(console.log("in parsedStaff"),(g.value.entries||[]).map(e=>({...e,to:`/about/staff/${e.to}`,image:v(e,"image[0]",null),staffName:`${e.nameFirst} ${e.nameLast}`,language:v(e,"alternativeName[0].languageAltName",null),alternativeFullName:v(e,"alternativeName[0].fullName",null),locations:v(e,"locations",[]).map(i=>({...i,uri:X(i.uri)}))}))));function w(e){if(console.log([w],e),!e)return{};const i={},o=e.split(" AND ");return console.log("conditions",o),o.forEach(k=>{const[m,d]=k.split(":("),C=m.trim(),le=d.replace(")","").split(" OR ").map(oe=>oe.trim());i[C]=le}),i}const te=N(["Academic Departments","Name","Contact Information"]),ae=A(()=>w(v(a,"query.filters",""))),y=N([]),L=N(!1),M=N([]),I=N(""),h=N({queryText:a.query.q||"",queryFilters:w(a.query.filters||"")});Q(()=>a.query,(e,i)=>{console.log("ES newVal, oldVal",e,i),h.value.queryText=a.query.q||"",h.value.queryFilters=w(a.query.filters||""),I.value=a.query.lastNameLetter,ne()},{deep:!0,immediate:!0});async function ne(){if(a.query.q&&a.query.q!==""||a.query.filters&&Ae(w(a.query.filters||""),S.staff.filters)||a.query&&a.query.lastNameLetter){console.log("Search ES HITS query,",a.query.q);let e=a.query.q||"*";a.query.lastNameLetter&&a.query.lastNameLetter!=="All"?e=e+` AND nameLast:${a.query.lastNameLetter}*`:a.query.lastNameLetter&&a.query.lastNameLetter==="All"&&(e=e+" AND nameLast:*");const{"subjectLibrarian.keyword":i,...o}=ae.value,k=i&&i.length>0&&i[0]==="yes"?[{term:{"subjectLibrarian.keyword":"yes"}}]:[];console.log("in router query in asyc data queryText",e);const m=await q.keywordSearchWithFilters(e,S.staff.searchFields,"sectionHandle:staffMember",o,S.staff.sortField,S.staff.orderBy,S.staff.resultFields,S.staff.filters,k);m&&m.hits&&m.hits.total.value>0?(console.log("Search ES HITS,",m.hits.hits),y.value=m.hits.hits,L.value=!1):(L.value=!0,y.value=[])}else y.value=[],L.value=!1}const P=A(()=>{const e=j.value,i=[],o=[];for(const m of e)for(const d of m.academicDepartments)o.push(d.title);const k=Array.from(new Set(o.sort()));for(const m of k)for(const d of e)for(const C of d.academicDepartments)m===C.title&&i.push({subjectArea:m,...d,staffName:d.alternativeName.length>0?`${d.nameFirst} ${d.nameLast} ${d.alternativeName[0].fullName}`:`${d.nameFirst} ${d.nameLast}`});return i}),ie=A(()=>`Search ${p.value.title}`),j=A(()=>y.value.map(e=>({...e._source,to:`/${e._source.uri}`,image:v(e._source.image,"[0]",null),alternativeFullName:e._source.alternativeName.length>0?e._source.alternativeName[0].fullName:null,language:e._source.alternativeName.length>0?e._source.alternativeName[0].languageAltName:null,staffName:`${e._source.nameFirst} ${e._source.nameLast}`,locations:v(e,"_source.locations",[]).map(i=>({...i,uri:X(i.uri)}))})));function J(e){const i=[];if(e.filters)for(const o in e.filters)e.filters[o].length>0&&i.push(`${o}:(${e.filters[o].join(" OR ")})`);z().push({path:"/about/staff",query:{q:h.value.queryText,filters:i.join(" AND "),lastNameLetter:e}})}function se(e){console.log("On the page getsearchdata called"),new URLSearchParams().append("q",e.text);const o=[];if(e.filters)for(const k in e.filters)e.filters[k].length>0&&o.push(`${k}:(${e.filters[k].join(" OR ")})`);z().push({path:"/about/staff",query:{q:e.text,lastNameLetter:a.query.lastNameLetter,filters:o.join(" AND ")}})}async function re(){const e=await q.getAggregations(S.staff.filters,"staffMember");console.log("Search Aggs Response: "+JSON.stringify(e)),M.value=we(e,S.staff.filters),console.log("searchFilters.value Response: "+JSON.stringify(M.value))}return fe(async()=>{console.log("onMounted called"),await re()}),(e,i)=>(x(),V("main",Re,[t(p)?(x(),ve(t(ye),{key:0,title:t(p).title||"",text:t(p).text||""},null,8,["title","text"])):ge("",!0),c(t(he),{"search-type":"about",filters:t(M),class:"generic-search","search-generic-query":t(h),placeholder:t(ie),onSearchReady:se},null,8,["filters","search-generic-query","placeholder"]),c(t(D),{theme:"divider"},{default:b(()=>[c(t(ke),{class:"search-margin"})]),_:1}),R(c(t(D),{class:"section-no-top-margin"},{default:b(()=>[c(t(K),{class:"browse-margin","selected-letter-prop":t(I),onSelectedLetter:J},null,8,["selected-letter-prop"]),c(t(W),{items:t(ee)},null,8,["items"])]),_:1},512),[[T,t(g).entries&&t(y).length==0&&!t(L)]]),R(c(t(D),{class:"section-no-top-margin"},{default:b(()=>[c(t(K),{class:"browse-margin","selected-letter-prop":t(I),onSelectedLetter:J},null,8,["selected-letter-prop"]),t(a).query.q?(x(),V("h2",Te,[E(" Displaying "+$(t(y).length)+" results for ",1),l("strong",null,[l("em",null,"“"+$(t(a).query.q)+"”",1)])])):(x(),V("h2",$e," Displaying "+$(t(y).length)+" results ",1)),c(t(W),{items:t(j)},null,8,["items"])]),_:1},512),[[T,t(y)&&t(y).length>0&&(t(h).queryFilters["subjectLibrarian.keyword"]&&t(h).queryFilters["subjectLibrarian.keyword"][0]===""||!t(h).queryFilters["subjectLibrarian.keyword"])]]),R(c(t(D),{class:"section-no-top-margin"},{default:b(()=>[l("div",Ee,[c(t(Ne),null,{default:b(()=>[l("h2",null,"Search for “"+$(t(a).query.q)+"” not found.",1),Be,Me]),_:1})])]),_:1},512),[[T,t(L)]]),R(c(t(D),{class:"section-no-top-margin"},{default:b(()=>[Ie,c(t(Se),{items:t(P),"table-headers":t(te)},null,8,["items","table-headers"])]),_:1},512),[[T,t(h).queryFilters["subjectLibrarian.keyword"]&&t(h).queryFilters["subjectLibrarian.keyword"][0]==="yes"&&t(P)]])]))}},Ke=ue(Ce,[["__scopeId","data-v-4e7b9f53"]]);export{Ke as default};
