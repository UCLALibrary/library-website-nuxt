import{_ as ee,u as ie,k as ne,l as te,m as U,r as h,a as B,p as N,L as ae,e as V,f as b,y as w,z as x,s as i,q as d,x as y,A as se,B as re,D as le,E as oe,F as z,G as S,U as P,H as q,I as F,h as v,M as ce,a1 as ue,S as de,T as ve}from"./D87QO4dW.js";import{u as me}from"./BWVOSsg_.js";import{_ as Q}from"./I9wROFQL.js";import{g as pe}from"./BIGQZk-7.js";import{c as g}from"./DSQ4ZnfI.js";import{q as ke}from"./BOdCFMn0.js";import{p as O}from"./iHpIRGTP.js";import{r as fe}from"./Dim8bG2a.js";import{s as he}from"./CfbswRTE.js";var D={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServiceResourceWorkshopSeriesList"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"serviceOrResource"},name:{kind:"Name",value:"entries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"section"},value:{kind:"StringValue",value:"serviceOrResource",block:!1}},{kind:"Argument",name:{kind:"Name",value:"orderBy"},value:{kind:"StringValue",value:"title ASC",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"serviceOrResource_serviceOrResource_Entry"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"to"},name:{kind:"Name",value:"uri"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"text"},name:{kind:"Name",value:"summary"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"category"},name:{kind:"Name",value:"serviceOrResourceType"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"iconName"},name:{kind:"Name",value:"illustrationsResourcesAndServices"},arguments:[],directives:[]}]}}]}},{kind:"Field",alias:{kind:"Name",value:"workshopseries"},name:{kind:"Name",value:"entries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"section"},value:{kind:"StringValue",value:"workshopOrEventSeries",block:!1}},{kind:"Argument",name:{kind:"Name",value:"workshopOrEventSeriesType"},value:{kind:"StringValue",value:"help/services-resources",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"workshopOrEventSeries_workshopOrEventSeries_Entry"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"to"},name:{kind:"Name",value:"uri"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"text"},name:{kind:"Name",value:"summary"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"category"},name:{kind:"Name",value:"workshopOrEventSeriesType"},arguments:[],directives:[]}]}}]}},{kind:"Field",alias:{kind:"Name",value:"externalResource"},name:{kind:"Name",value:"entries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"section"},value:{kind:"StringValue",value:"externalResource",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"text"},name:{kind:"Name",value:"summary"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"slug"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"to"},name:{kind:"Name",value:"externalResourceUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"externalResourceUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sectionHandle"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"typeHandle"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayEntry"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"entry"},arguments:[{kind:"Argument",name:{kind:"Name",value:"section"},value:{kind:"StringValue",value:"listingServicesResources",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"listingServicesResources_listingServicesResources_Entry"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"text"},name:{kind:"Name",value:"summary"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:1012}};D.loc.source={body:`query ServiceResourceWorkshopSeriesList {
  serviceOrResource: entries(
    section: "serviceOrResource"
    orderBy: "title ASC"
  ) {
    ... on serviceOrResource_serviceOrResource_Entry {
      id
      to: uri
      title
      text: summary
      category: serviceOrResourceType
      iconName: illustrationsResourcesAndServices
    }
  }
  workshopseries: entries(
    section: "workshopOrEventSeries"
    workshopOrEventSeriesType: "help/services-resources"
  ) {
    ... on workshopOrEventSeries_workshopOrEventSeries_Entry {
      id
      to: uri
      title
      text: summary
      category: workshopOrEventSeriesType
    }
  }
  externalResource: entries(section: "externalResource") {
    title
    text: summary
    slug
    to: externalResourceUrl
    externalResourceUrl
    sectionHandle
    typeHandle
    displayEntry
  }
  entry(section: "listingServicesResources") {
    ... on listingServicesResources_listingServicesResources_Entry {
      id
      title
      text: summary
    }
  }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function E(e,n){if(e.kind==="FragmentSpread")n.add(e.name.value);else if(e.kind==="VariableDefinition"){var a=e.type;a.kind==="NamedType"&&n.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(s){E(s,n)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(s){E(s,n)}),e.definitions&&e.definitions.forEach(function(s){E(s,n)})}var L={};(function(){D.definitions.forEach(function(n){if(n.name){var a=new Set;E(n,a),L[n.name.value]=a}})})();function W(e,n){for(var a=0;a<e.definitions.length;a++){var s=e.definitions[a];if(s.name&&s.name.value==n)return s}}function ye(e,n){var a={kind:e.kind,definitions:[W(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var s=L[n]||new Set,k=new Set,u=new Set;for(s.forEach(function(r){u.add(r)});u.size>0;){var o=u;u=new Set,o.forEach(function(r){if(!k.has(r)){k.add(r);var m=L[r]||new Set;m.forEach(function(c){u.add(c)})}})}return k.forEach(function(r){var m=W(e,r);m&&a.definitions.push(m)}),a}ye(D,"ServiceResourceWorkshopSeriesList");var H={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"HelpTopicList"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entries"},arguments:[{kind:"Argument",name:{kind:"Name",value:"section"},value:{kind:"StringValue",value:"helpTopic",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"helpTopic_helpTopic_Entry"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"to"},name:{kind:"Name",value:"uri"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"text"},name:{kind:"Name",value:"summary"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"typeHandle"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:221}};H.loc.source={body:`query HelpTopicList {
    entries(section: "helpTopic") {
        ... on helpTopic_helpTopic_Entry {
            id
            to: uri
            title
            text: summary
            typeHandle
        }
    }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function T(e,n){if(e.kind==="FragmentSpread")n.add(e.name.value);else if(e.kind==="VariableDefinition"){var a=e.type;a.kind==="NamedType"&&n.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(s){T(s,n)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(s){T(s,n)}),e.definitions&&e.definitions.forEach(function(s){T(s,n)})}var C={};(function(){H.definitions.forEach(function(n){if(n.name){var a=new Set;T(n,a),C[n.name.value]=a}})})();function G(e,n){for(var a=0;a<e.definitions.length;a++){var s=e.definitions[a];if(s.name&&s.name.value==n)return s}}function ge(e,n){var a={kind:e.kind,definitions:[G(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var s=C[n]||new Set,k=new Set,u=new Set;for(s.forEach(function(r){u.add(r)});u.size>0;){var o=u;u=new Set,o.forEach(function(r){if(!k.has(r)){k.add(r);var m=C[r]||new Set;m.forEach(function(c){u.add(c)})}})}return k.forEach(function(r){var m=G(e,r);m&&a.definitions.push(m)}),a}ge(H,"HelpTopicList");const M=e=>(de("data-v-340c634b"),e=e(),ve(),e),Se={id:"main",class:"page page-help"},Re={key:0,class:"about-results"},_e={key:1,class:"about-results"},Ne={class:"error-text"},we=M(()=>v("p",null,[q(" We can’t find the term you are looking for on this page, but we're here to help. "),v("br"),q(" Try searching the whole site from "),v("a",{href:"https://library.ucla.edu"},"UCLA Library Home"),q(", or try one of the these regularly visited links: ")],-1)),xe=M(()=>v("ul",null,[v("li",null,[v("a",{href:"https://www.library.ucla.edu/research-teaching-support/research-help"},"Research Help")]),v("li",null,[v("a",{href:"/help/services-resources/ask-us"},"Ask Us")]),v("li",null,[v("a",{href:"https://www.library.ucla.edu/use/access-privileges/disability-resources"},"Accessibility Resources")])],-1)),Fe={__name:"index",async setup(e){let n,a;const{$graphql:s,$elasticsearchplugin:k,$dataApi:u}=ie(),o=ne(),{data:r,error:m}=([n,a]=te(async()=>se("services-resources-list",async()=>{const t=await s.default.request(D),l=await s.default.request(H);return{data:t,helpTopicData:l}})),n=await n,a(),n);if(m.value)throw U({...m.value,statusMessage:"Page not found."+m.value,fatal:!0});if(!r.value.data&&!r.value.helpTopicData)throw U({statusCode:404,message:"Page not found",fatal:!0});r.value.data.externalResource&&r.value.data.externalResource.length>0;const c=h(r.value.data),_=h(r.value.helpTopicData),f=h(Q(r.value.data,"entry",{}));B(r,(t,l)=>{c.value=t.data,_.value=t.helpTopicData,f.value=Q(t.data,"entry",{})});const p=h([]),R=h(!1),I=h([]),A=h({queryText:o.query.q||"",queryFilters:O(o.query.filters||"")});B(()=>o.query,(t,l)=>{console.log("ES newVal, oldVal",t,l),A.value.queryText=o.query.q||"",A.value.queryFilters=O(o.query.filters||""),J()},{deep:!0,immediate:!0});async function J(){if(o.query.q&&o.query.q!==""||o.query.filters&&ke(O(o.query.filters||""),g.serviceOrResources.filters)){const t=o.query.q||"*",l=await u.keywordSearchWithFilters(t,g.serviceOrResources.searchFields,"(sectionHandle:serviceOrResource OR sectionHandle:workshopSeries OR sectionHandle:helpTopic) OR (sectionHandle:externalResource AND displayEntry:yes)",O(o.query.filters||""),g.serviceOrResources.sortField,g.serviceOrResources.orderBy,g.serviceOrResources.resultFields);l&&l.hits&&l.hits.total.value>0?(p.value=l.hits.hits,R.value=!1):(R.value=!0,p.value=[])}else p.value=[],R.value=!1}me({title:c.value?f.value.title:"... loading",meta:[{hid:"description",name:"description",content:fe(f.value.text)}]}),N(()=>c.value&&(c.value.serviceOrResource||c.value.workshopseries||c.value.externalResource||_.value.entries)?[...c.value.serviceOrResource||[],...c.value.workshopseries||[],...c.value.externalResource||[],..._.value.entries||[]]:[]);const K=N(()=>{const t=(c.value.externalResource||[]).filter(l=>l.displayEntry==="yes");return[...c.value.serviceOrResource||[],...c.value.workshopseries||[],...t||[],..._.value.entries||[]].sort(he).map(l=>({...l,category:l.category==="help/services-resources"?"workshop series":l.typeHandle==="helpTopic"?"help topic":l.typeHandle==="externalResource"?"resource":l.category,to:l.typeHandle==="externalResource"?`${l.to}`:`/${l.to}`}))}),X=N(()=>`Search ${f.value.title}`),Y=N(()=>p.value.map(t=>({title:t._source.title,sectionHandle:t._source.sectionHandle,to:t._source.sectionHandle==="externalResource"?`${t._source.externalResourceUrl}`:`/${t._source.uri}`,iconName:t._source.illustrationsResourcesAndServices,text:t._source.text||t._source.summary,category:t._source.sectionHandle==="workshopSeries"?"workshop":t._source.sectionHandle==="helpTopic"?"help topic":t._source.sectionHandle==="externalResource"?"resource":t._source.type})));ae(async()=>{await Z()});async function Z(){const t=await u.getAggregations(g.serviceOrResources.filters,"serviceOrResource OR workshopSeries OR helpTopic OR externalResource");I.value=pe(t,g.serviceOrResources.filters)}function j(t){console.log("On the page getsearchdata called");const l=[];for(const $ in t.filters)t.filters[$].length>0&&l.push(`${$}:(${t.filters[$].join(" OR ")})`);re().push({path:"/help/services-resources",query:{q:t.text,filters:l.join(" AND ")}})}return(t,l)=>(V(),b("main",Se,[w(d(i(le),{title:i(f).title||"",text:i(f).text||""},null,8,["title","text"]),[[x,i(f)]]),d(i(oe),{"search-type":"help",class:"generic-search",filters:i(I),"search-generic-query":i(A),placeholder:i(X),onSearchReady:j},null,8,["filters","search-generic-query","placeholder"]),d(i(S),{theme:"divider"},{default:y(()=>[d(i(z),{color:"help",class:"search-margin"})]),_:1}),w(d(i(S),{class:"section-no-top-margin"},{default:y(()=>[d(i(P),{items:i(K),"is-horizontal":!0},null,8,["items"])]),_:1},512),[[x,(i(c).serviceOrResource||i(c).workshopseries)&&i(p).length==0&&!i(R)]]),w(d(i(S),{class:"section-no-top-margin"},{default:y(()=>[i(o).query&&i(o).query.q?(V(),b("h2",Re,[q(" Displaying "+F(i(p).length)+" results for ",1),v("strong",null,[v("em",null,"“"+F(i(o).query.q)+"”",1)])])):(V(),b("h2",_e," Displaying "+F(i(p).length)+" results ",1)),d(i(P),{items:i(Y),"is-horizontal":!0},null,8,["items"])]),_:1},512),[[x,i(p)&&i(p).length>0]]),w(d(i(S),{class:"section-no-top-margin"},{default:y(()=>[v("div",Ne,[d(i(ce),null,{default:y(()=>[v("h2",null,"Search for “"+F(i(o).query.q)+"” not found.",1),we,xe]),_:1})])]),_:1},512),[[x,i(R)&&i(o).query.q]]),d(i(S),null,{default:y(()=>[d(i(z),{class:"divider-way-finder",color:"help"})]),_:1}),d(i(S),null,{default:y(()=>[d(i(ue),{class:"block-call-to-action","is-global":!0})]),_:1})]))}},be=ee(Fe,[["__scopeId","data-v-340c634b"]]);export{be as default};
